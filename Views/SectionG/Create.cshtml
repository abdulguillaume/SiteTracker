@model Nigeria_Reg.Models.SurveyViewG

@{
    ViewBag.Title = "Create SectionG";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Create Survey/Section G</h2>

@if (ViewBag.Exception != null)
{
    <p style="color: Red">@ViewBag.Exception</p>
}

<script>
    $(function () {

        $("#forma").on("keyup change", "[class^=pline-]", function (e) {
            var trid = $(this).closest('tr').attr('id');
            if ($(this).val() != '') {
                $('.cb_' + trid).prop('checked', true);
            }
        });

        $('[class^=cb_]').click(function (e) {
            if (!$(this).is(':checked')) {
                var trid = $(this).closest('tr').attr('id');

                $('#' + trid).find('input[type=text], select').each(function () {
                    $(this).val('');
                });
                $('.cb_' + trid).prop('checked', false);

            }
        });

    });
</script>

<hr />
    <table class="table table-striped table-condensed table-hover">
        <thead>
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.site.SSID)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.site.SiteName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.site.Type)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.survey.SurveyDate)
                </th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>
                    @ViewBag.SSID
                </td>
                <td>
                    @ViewBag.SiteName
                </td>
                <td>
                    @ViewBag.SiteType
                </td>
                <td>
                    @ViewBag.s_date
                </td>
            </tr>
        </tbody>
    </table>

@using (Html.BeginForm("Create", "SectionG", FormMethod.Post, new { id = "forma" }))

{

    @*@Html.AntiForgeryToken()*@

    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <fieldset>

        <br />
        <table class="table">
            <tr><th colspan="4"><div class="text-danger">G. HEALTH/NUTRITION</div></th></tr>
            <tr>
                <th colspan=4>
                    <div class="text-danger">
                        G.1a. Activities carried out during the week
                    </div>
                </th>
            </tr>

            <tr>
                <td>
                    Supplementary feeding for children<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_SupplementaryFeeding_ch)
                        @Html.ValidationMessageFor(m => m.g.b_SupplementaryFeeding_ch)
                    </div>
                </td>
                <td>
                    Supplementary feeding for pregnant and lactating mothers<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_SupplementaryFeeding_mo)
                        @Html.ValidationMessageFor(m => m.g.b_SupplementaryFeeding_mo)
                    </div>
                </td>
                <td>
                    Vaccination<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_Vaccination)
                        @Html.ValidationMessageFor(m => m.g.b_Vaccination)
                    </div>
                </td>
                <td>
                    Establishment of health structure<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_HealthStucture_Establishment)
                        @Html.ValidationMessageFor(m => m.g.b_HealthStucture_Establishment)
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    Medical referrals<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_MedicalReferrals)
                        @Html.ValidationMessageFor(m => m.g.b_MedicalReferrals)
                    </div>
                </td>
                <td>
                    Food distribution<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_FoodDistribution)
                        @Html.ValidationMessageFor(m => m.g.b_FoodDistribution)
                    </div>
                </td>
                <td>
                    Other activity carried<div class="col-md-10">
                        @Html.CheckBoxFor(m => m.g.b_Other)
                        @Html.ValidationMessageFor(m => m.g.b_Other)
                    </div>
                </td>
                <td>
                    If other specify:<div class="display-field">
                        @Html.TextBoxFor(m => m.g.Other_activity_spec)
                        @Html.ValidationMessageFor(m => m.g.Other_activity_spec)
                    </div>

                </td>
            </tr>


            <tr><th colspan="3"><div class="text-danger">G.1b. Gaps requiring intervention under week in review</div></th></tr>

            <tr>
                <td colspan="1">Quality of healthcare delivery</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.HealthCare_quality, 1, false) Excellent
                        @Html.RadioButtonFor(m => m.g.HealthCare_quality, 2, false) Very Good
                        @Html.RadioButtonFor(m => m.g.HealthCare_quality, 3, false) Good
                        @Html.RadioButtonFor(m => m.g.HealthCare_quality, 4, false) Poor
                        @Html.RadioButtonFor(m => m.g.HealthCare_quality, 5, false) Very Poor

                        @Html.ValidationMessageFor(m => m.g.HealthCare_quality)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">Disease outbreak?</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.DiseaseOutbreak, 1, false) Yes
                        @Html.RadioButtonFor(m => m.g.DiseaseOutbreak, 2, false) No

                        @Html.ValidationMessageFor(m => m.g.DiseaseOutbreak)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">If yes, which?</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.WichDisease, 1, false) Diarrhea
                        @Html.RadioButtonFor(m => m.g.WichDisease, 2, false) Malaria
                        @Html.RadioButtonFor(m => m.g.WichDisease, 3, false) RTI
                        @Html.RadioButtonFor(m => m.g.WichDisease, 4, false) Fever
                        @Html.RadioButtonFor(m => m.g.WichDisease, 5, false) Cough
                        @Html.RadioButtonFor(m => m.g.WichDisease, 6, false) Malnutrition
                        <p>
                            @Html.RadioButtonFor(m => m.g.WichDisease, 7, false) Wound Infection
                            @Html.RadioButtonFor(m => m.g.WichDisease, 8, false) Skin Disease
                            @Html.RadioButtonFor(m => m.g.WichDisease, 9, false) Cholera
                            @Html.RadioButtonFor(m => m.g.WichDisease, 10, false) Measles
                            @Html.RadioButtonFor(m => m.g.WichDisease, 11, false) Other
                        </p>

                        @Html.ValidationMessageFor(m => m.g.WichDisease)
                    </div>
                </td>
                <td colspan="1">
                    If other specify:<div class="display-field">
                        @Html.TextBoxFor(m => m.g.OtherDisease_spec)
                        @Html.ValidationMessageFor(m => m.g.OtherDisease_spec)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">Location of nearest health facility</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.HealthFacLoc, 1, false) Onsite (< 1km)
                        @Html.RadioButtonFor(m => m.g.HealthFacLoc, 2, false) Onsite (> 1km)
                        @Html.RadioButtonFor(m => m.g.HealthFacLoc, 3, false) Offsite
                        @Html.RadioButtonFor(m => m.g.HealthFacLoc, 4, false) None

                        @Html.ValidationMessageFor(m => m.g.HealthFacLoc)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">Access to food</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.FoodAccess, 1, false) Yes, onsite
                        @Html.RadioButtonFor(m => m.g.FoodAccess, 2, false) Yes, offsite
                        @Html.RadioButtonFor(m => m.g.FoodAccess, 3, false) No

                        @Html.ValidationMessageFor(m => m.g.FoodAccess)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">Access to market</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.MarketAccess, 1, false) Yes
                        @Html.RadioButtonFor(m => m.g.MarketAccess, 2, false) No

                        @Html.ValidationMessageFor(m => m.g.MarketAccess)
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="1">Meals per Day</td>
                <td colspan="1">
                    <div class="display-radio">
                        @Html.RadioButtonFor(m => m.g.MealsPerDay, 1, false) Thrice a day
                        @Html.RadioButtonFor(m => m.g.MealsPerDay, 2, false) Twice a day
                        @Html.RadioButtonFor(m => m.g.MealsPerDay, 3, false) Once a day
                        <p>
                            @Html.RadioButtonFor(m => m.g.MealsPerDay, 4, false) Evetry 2 days
                            @Html.RadioButtonFor(m => m.g.MealsPerDay, 5, false) Irregular
                            @Html.RadioButtonFor(m => m.g.MealsPerDay, 6, false) Never
                        </p>

                        @Html.ValidationMessageFor(m => m.g.MealsPerDay)
                    </div>
                </td>
            </tr>
            <tr>
                <th colspan="1">
                    <div class="text-danger">
                        G.2. Comments
                    </div>
                </th>
            </tr>
            <tr>
                <td>
                    <div class="editor-field">
                        @Html.TextAreaFor(m => m.g.Comments, new { cols = 200, @rows = 6 })
                        @Html.ValidationMessageFor(m => m.g.Comments)
                    </div>
                </td>
            </tr>

            <tr>
                <th colspan="1">
                    <div class="text-danger">
                        G.3. Services and facilities donated (during the week in review)
                    </div>
                </th>
            </tr>
            <tr>
                <td colspan="8">

                    <table width="100%" class="table">
                        <tr>
                            <th></th>
                            <th>S/N</th>
                            <th>Sub-Category</th>
                            <th>Description</th>
                            <th>QTTY</th>
                            <th>Latitude</th>
                            <th>Longitude</th>
                            <th>Provided by?</th>
                            <th>Remark</th>
                        </tr>

                        @for (int i = 0; i < Model.srv.Count(); i++)
                        {
                            int j = i+1;
                            //j = j + 1;
                            <tr id='@i'>

                                <td>
                                    @Html.HiddenFor(model => model.srv[i].SurveyID)
                                    <div class="col-md-10">
                                        @Html.CheckBoxFor(model => model.srv[i].notEmpty, new { @class = "cb_" + @i })
                                    </div>
                                </td>
                                <td>
                                    @Html.HiddenFor(model => model.srv[i].SN)
                                    @j
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.DropDownListFor(model => model.srv[i].SubCat, new SelectList((SelectList)ViewBag.HN_SubCat, "Value", "Text", Model.srv[i].SubCat), "[Select]", new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].SubCat)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.DropDownListFor(model => model.srv[i].Description, new SelectList((SelectList)ViewBag.HN_Desc, "Value", "Text", Model.srv[i].Description), "[Select]", new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].Description)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10 txtresize">
                                        @Html.TextBoxFor(model => model.srv[i].QTTY, new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].QTTY)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.TextBoxFor(model => model.srv[i].Lat, new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].Lat)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.TextBoxFor(model => model.srv[i].Lon, new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].Lon)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.DropDownListFor(model => model.srv[i].Provider, new SelectList((SelectList)ViewBag.Prov, "Value", "Text", Model.srv[i].Provider), "[Select]", new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].Provider)
                                    </div>
                                </td>
                                <td>
                                    <div class="col-md-10">
                                        @Html.TextBoxFor(model => model.srv[i].Remark, new { @class = "pline-" + @i })
                                        @Html.ValidationMessageFor(model => model.srv[i].Remark)
                                    </div>
                                </td>


                            </tr>
                        }
                    </table>
                </td>
            </tr>
        </table>

             <div class="editor-field">
                <hr />
 
                <table>
                    <tr>
                        <th colspan="8">
                            <div class="text-danger">
                                H. Active Partners on Site
                            </div>
                        </th>
                    </tr>
                    <tr>
                        @{
                                int cnt = 0;
                                List<Nigeria_Reg.Models.ViewModel.ActivePartnersViewModel> partners = ViewBag.Partners;
                            
                                foreach(var partner in partners)
                                {
                                    if (cnt++ % 8 == 0)
                                    {
                                        @:</tr><tr>
                                    }
                                
                                    @:<td>
                                        <input type="checkbox" name="SelectedPartners" value="@partner.PartnerId"
                                               @(Html.Raw(partner.isSelected ? "checked=\"checked\"" : "")) />
                            
                                                @*@partner.PartnerId*@  @: @partner.PartnerName
                                    @: </td>

                                }
                            
                                @: </tr>        
                        }   
                    
                        
                    <tr>
                        <th colspan="8">
                            <div class="text-danger">
                                Other active Partners on Site
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <td>
                            <div class="editor-field">
                                @Html.TextAreaFor(m => m.g.ActivePartnersOnSite, new { cols = 200, @rows = 6 })
                                @Html.ValidationMessageFor(m => m.g.ActivePartnersOnSite)
                            </div>
                    </tr>

                </table>


            </div>

        <br />
                        
        <p>
            <input type="submit" value="Save" /> | @Html.ActionLink("Cancel", "Index", new { id = (int)ViewBag.s_id })
        </p>
</fieldset>
}

<br />
<div>
    @Html.ActionLink("Back to SectionF", "Index", "SectionF", new RouteValueDictionary(new { id = (int)ViewBag.s_id }), null)
</div>

